% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CreatePCATable.R
\name{CreatePCATable}
\alias{CreatePCATable}
\title{Create PCA table and visualization}
\usage{
CreatePCATable(
  Data,
  VarsToReduce,
  VariableCategories = NULL,
  minThresh = 0.85,
  scale = TRUE,
  center = TRUE,
  Ordinal = FALSE,
  numComponents = NULL
)
}
\arguments{
\item{Data}{The dataset containing the variables for PCA.}

\item{VarsToReduce}{A character vector specifying the variables to include in the PCA.}

\item{VariableCategories}{Optional categorical vector, used to color the lollipop plot.
Must be the same length and order as VarsToReduce if provided.}

\item{minThresh}{The minimum threshold for cumulative proportion of variance (default 0.85).}

\item{scale}{Logical, indicating whether to scale the data (divide by SD). Default TRUE.}

\item{center}{Logical, indicating whether to center the data (subtract mean). Default TRUE.}

\item{Ordinal}{Logical, indicating whether ordinal variables should be handled.
Currently not used inside this function.}

\item{numComponents}{Number of principal components to compute. If NULL, chosen by minThresh.}
}
\value{
A list containing PCA results and visualizations:
\item{p_scree}{Scree and variance plot (ggplot object).}
\item{pcaresults}{psych::principal result (after psych::fa.sort).}
\item{LoadingTable}{Data frame of loadings with variable names and labels.}
\item{Scores}{Matrix or data frame of component scores.}
\item{CombinedData}{Original Data with component scores appended.}
\item{Lollipop}{Lollipop style loading plot (ggplot object).}
\item{ScaleParams}{List with elements means, sds, center, scale.}
\item{VarsUsed}{Character vector of variables actually used in PCA.}
\item{Center}{Logical flag indicating if centering was used.}
\item{Scale}{Logical flag indicating if scaling was used.}
}
\description{
Perform principal component analysis (PCA) on specified variables and create visualizations.
}
