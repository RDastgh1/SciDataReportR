% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MakeComparisonTable.R
\name{MakeComparisonTable}
\alias{MakeComparisonTable}
\title{Make a Group Comparison Table (gtsummary wrapper)}
\usage{
MakeComparisonTable(
  DataFrame,
  Variables = NULL,
  CompVariable,
  Covariates = NULL,
  ValueDigits = 2,
  pDigits = 3,
  AddEffectSize = FALSE,
  EffectSizeDigits = 2,
  AddPairwise = FALSE,
  PairwiseMethod = "bonferroni",
  ReferentGroup = NULL
)
}
\arguments{
\item{DataFrame}{A data frame containing the data for generating the comparison table.}

\item{Variables}{An optional character vector of variable names (besides the grouping variable) to include in the comparison table. If \code{NULL}, all variables in \code{DataFrame} are used.}

\item{CompVariable}{A character string specifying the name of the variable used to divide the data into comparison groups.}

\item{ValueDigits}{An integer specifying the number of digits to display for continuous variable statistics (mean and standard deviation). Default is 2.}

\item{pDigits}{An integer specifying the number of digits to display for p-values. Default is 3.}

\item{AddEffectSize}{A logical value indicating whether to add effect size measures. Default is FALSE.}

\item{EffectSizeDigits}{An integer specifying the number of digits to display for effect size statistics. Default is 2.}

\item{AddPairwise}{A logical value indicating whether to add pairwise post-hoc comparisons for multi-group analyses. Default is FALSE.}

\item{PairwiseMethod}{A character string specifying the p-value adjustment method for pairwise comparisons. Default is "bonferroni". Other options include "holm", "hochberg", "hommel", "BH", "BY", "fdr", "none".}

\item{ReferentGroup}{An optional character string specifying a reference group for pairwise comparisons. If provided, only comparisons between this group and other groups will be shown. Default is NULL (all pairwise comparisons).}
}
\value{
A gtsummary table object with the comparison results.
}
\description{
This function creates a summary comparison table from a given data frame. It summarizes continuous variables with their mean (and standard deviation) and categorical variables with counts and percentages. Comparisons between groups are performed based on a specified grouping (comparison) variable.
}
\details{
The function first determines the set of variables to analyze. If \code{Variables} is \code{NULL}, all variables from \code{DataFrame} are used; otherwise, it ensures that \code{CompVariable} is included once in the analysis. Next, it filters the data frame to include only the selected variables and excludes any factor variables with more than 15 unique levels. The summary is then created using \code{\link[gtsummary]{tbl_summary}} with continuous variables summarized as "mean (sd)" and categorical variables summarized as "n (p)". Additional information, such as sample sizes, p-values, and optionally effect sizes, is appended to the table.

When effect sizes are requested, the function calculates Cohen's d for continuous variables and Cramer's V for categorical variables.

For multi-group comparisons, post-hoc pairwise tests can be added when \code{AddPairwise = TRUE}. Significant p-values are displayed in bold. If \code{ReferentGroup} is specified, only comparisons between the reference group and other groups will be shown.
}
\note{
This wrapper function is adapted from code written by Aparna Bhattacharyya.
}
