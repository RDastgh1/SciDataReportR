% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CombineCodebooks.R
\name{CombineCodebooks}
\alias{CombineCodebooks}
\title{Combine Two Codebooks with Conflict Detection}
\usage{
CombineCodebooks(OldCodebook, NewCodebook, key = "Variable")
}
\arguments{
\item{OldCodebook}{A data.frame or tibble representing the old codebook.  Each row must correspond to a single variable entry.}

\item{NewCodebook}{A data.frame or tibble representing the new codebook.  Must have the same structure (column names) as \code{OldCodebook}, though extra or missing columns will be handled.}

\item{key}{A string giving the name of the key column to identify variables (e.g. "Variable").  Defaults to "Variable".}
}
\value{
A list with elements:
\itemize{
\item \code{added_variables}: character vector of keys present only in \code{NewCodebook}.
\item \code{removed_variables}: character vector of keys present only in \code{OldCodebook}.
\item \code{columns_added}: character vector of column names present only in \code{NewCodebook}.
\item \code{columns_removed}: character vector of column names present only in \code{OldCodebook}.
\item \code{value_differences}: tibble of cell-level differences (\code{RowID}, \code{Field}, \code{OldValue}, \code{NewValue}).
\item \code{combined_df}: tibble containing the merged codebook with versions and conflict flag.
}
}
\description{
\code{CombineCodebooks} compares two codebook data frames (an old version and a new version), identifies added or removed variables and columns, detects cell-by-cell differences, and produces a combined codebook.  For records without any differences, it returns a single "Combined" row; for records with differences, it returns both the "Old" and "New" rows, flagged as conflicts.
}
\details{
This function:
\itemize{
\item Builds a \code{combined_df} that includes all columns from both inputs:
\itemize{
\item For non-conflicting records, a single row with \code{Version = "Combined"}.
\item For conflicting records, two rows: one with \code{Version = "Old"} and one with \code{Version = "New"}.
}
\item Flags each row with \code{CHECKFORCONFLICTS} (0 for combined, 1 for old/new conflict rows).
}
}
