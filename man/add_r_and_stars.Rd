% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/add_r_and_stars.R
\name{add_r_and_stars}
\alias{add_r_and_stars}
\title{Add r-values and significance stars to a correlations heatmap (pass \code{res})}
\usage{
add_r_and_stars(
  res,
  star_from = c("existing", "raw", "fdr", "P", "P_adj", "column"),
  star_col = NULL,
  r_var = "R",
  r_digits = 2,
  r_size = 3,
  r_color = "black",
  r_nudge_y = -0.28,
  star_size = 6,
  star_color = "black",
  star_nudge_y = 0.28,
  remove_existing_stars = TRUE,
  p_breaks = c(-Inf, 0.001, 0.01, 0.05, Inf),
  p_labels = c("***", "**", "*", "")
)
}
\arguments{
\item{res}{The list returned by PlotCorrelationsHeatmap()}

\item{star_from}{One of:
\itemize{
\item "existing" : use whatever the chosen plot already mapped as stars
\item "raw"      : use \code{stars} if present, else compute from \code{P}
\item "fdr"      : use \code{stars_FDR} if present, else compute from \code{P_adj}
\item "P"        : compute stars from \code{P} cutpoints
\item "P_adj"    : compute stars from \code{P_adj} cutpoints
\item "column"   : use a custom column name given by \code{star_col}
Notes:
\itemize{
\item "raw" and "P" prefer res$Unadjusted$plot; "fdr" and "P_adj" prefer res$FDRCorrected$plot.
\item "existing" picks the plot that already mapped a stars column (FDR preferred).
}
}}

\item{star_col}{Column name to use when star_from = "column"}

\item{r_var}{Column name for correlation values (default "R")}

\item{r_digits}{Decimal places for r labels}

\item{r_size}{Text size for r labels}

\item{r_color}{Color for r labels}

\item{r_nudge_y}{Vertical nudge for r (negative = below center)}

\item{star_size}{Text size for star labels}

\item{star_color}{Color for star labels}

\item{star_nudge_y}{Vertical nudge for stars (positive = above center)}

\item{remove_existing_stars}{If TRUE, remove any pre-existing star text layers}

\item{p_breaks}{Cutpoints for pâ†’stars (default c(-Inf, .001, .01, .05, Inf))}

\item{p_labels}{Labels for those cutpoints (default c("\emph{\strong{","}","}",""))}
}
\value{
A ggplot with r-values and stars added
}
\description{
Works with the list returned by PlotCorrelationsHeatmap(). Chooses the
appropriate ggplot inside \code{res} based on \code{star_from}, draws r-values slightly
below center, and draws significance stars slightly above center.
}
